[
  {
    "objectID": "Maine/Methods.html",
    "href": "Maine/Methods.html",
    "title": "Methods",
    "section": "",
    "text": "Ruby Krasnow Last modified: July 14, 2023\nLoad packages\nlibrary(tidyverse)\nlibrary(lubridate) #date formatting\nlibrary(patchwork) #combining plots\nlibrary(tseries) #for KPSS test for stationarity\nlibrary(rEDM) #EDM\n\n#spatial packages\nlibrary(sf)\nlibrary(sfheaders)\nlibrary(spdep)"
  },
  {
    "objectID": "spatialExploration.html",
    "href": "spatialExploration.html",
    "title": "Spatial Exploration",
    "section": "",
    "text": "Spatial data exploration\nRuby Krasnow\nLast modified: June 24, 2023\nLoad packages\n\nlibrary(sf)\nlibrary(NEFSCspatial)\nlibrary(tidyverse)\n\nSMAST scallop data (HabCam)\n\n# SMAST Scallop data-----------------------------------------------------------------\n# The data I want, but averaged across years\n\nst_layers(\"data/SMAST_SCALLOP/SMAST_Scallops.gdb\")\n\nDriver: OpenFileGDB \nAvailable layers:\n                layer_name geometry_type features fields crs_name\n1 AveragePresenceAbundance Multi Polygon      920     32    NAD83\n\ntest&lt;- st_read(\"data/SMAST_SCALLOP/SMAST_Scallops.gdb\")\n\nReading layer `AveragePresenceAbundance' from data source \n  `/Users/rubykrasnow/Downloads/lab_notebook/data/SMAST_SCALLOP/SMAST_Scallops.gdb' \n  using driver `OpenFileGDB'\nSimple feature collection with 920 features and 32 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -75.14375 ymin: 36.39138 xmax: -66.32867 ymax: 42.49109\nGeodetic CRS:  NAD83\n\nclass(test)\n\n[1] \"sf\"         \"data.frame\"\n\nprint(test[1:15], n = 3)\n\nSimple feature collection with 920 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -75.14375 ymin: 36.39138 xmax: -66.32867 ymax: 42.49109\nGeodetic CRS:  NAD83\nFirst 3 features:\n  F100km_Id F1000Km_Id AreaKm Stations DepthAve ScallopAve SeaStarAve  CrabAve\n1      1024         28    100        2    20.00       0.00        4.5 0.000000\n2      1097         28    100        4    20.85       0.75        4.0 0.000000\n3      1098         28    100        3    18.50       0.00        5.0 0.333333\n  HerCrabAve SandDolAve BryHydAve HolesAve MnSnailAve SpongeAve FlatFishAv\n1          0          0         0                             0          0\n2          0          0         0                             0          0\n3          0          0         0                             0          0\n                           Shape\n1 MULTIPOLYGON (((-75.02578 3...\n2 MULTIPOLYGON (((-74.91487 3...\n3 MULTIPOLYGON (((-74.9217 36...\n\npar(mar = c(0,0,1,0))\nplot(test[6])\n\n\n\n\nNEFSC scallop survey data: time series, but doesn’t include predation info\n\n# NEFSC scallop survey data - through 2015 -----------------------------------------------------------------\n\nst_layers(\"~/Downloads/Fish/Fish.gdb\")\n\nDriver: OpenFileGDB \nAvailable layers:\n                                                layer_name geometry_type\n1                                EFH_Overlay_Final_Jan2015 Multi Polygon\n2                         HighlyMigratorySpeciesEFHOverlay Multi Polygon\n3                                           ScallopBiomass         Point\n4          SeaScallops2016_2018PotentialReproductiveOutput Multi Polygon\n5 fras_aux_SeaScallops2016_2018PotentialReproductiveOutput            NA\n6 fras_blk_SeaScallops2016_2018PotentialReproductiveOutput            NA\n7 fras_bnd_SeaScallops2016_2018PotentialReproductiveOutput            NA\n8 fras_ras_SeaScallops2016_2018PotentialReproductiveOutput            NA\n9      vat_SeaScallops2016_2018PotentialReproductiveOutput            NA\n  features fields                 crs_name\n1     1713     44 WGS 84 / Pseudo-Mercator\n2    42474     45                    NAD83\n3    16057      8                    NAD83\n4        1      3                   WGS 84\n5        2      3                     &lt;NA&gt;\n6       63      6                     &lt;NA&gt;\n7        1     18                     &lt;NA&gt;\n8        1      3                     &lt;NA&gt;\n9        3      2                     &lt;NA&gt;\n\nfish&lt;- st_read(\"~/Downloads/Fish/Fish.gdb\", layer=\"ScallopBiomass\")\n\nReading layer `ScallopBiomass' from data source \n  `/Users/rubykrasnow/Downloads/Fish/Fish.gdb' using driver `OpenFileGDB'\nSimple feature collection with 16057 features and 8 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -75.63333 ymin: 35.55 xmax: -65.916 ymax: 42.16667\nGeodetic CRS:  NAD83\n\n# st_geometry(fish)\n# class(fish)\n\npar(mar = c(0,0,1,0))\nplot(fish[6])\n\n\n\nfish&lt;- fish %&gt;% \n  filter(year_ &gt; 1966) %&gt;% \n  mutate(YEAR = year_, .keep = \"unused\") %&gt;%\n  na.omit()\n\n\n# NEFSC Spatial package - maps of shellfish strata -----------------------------------------------------------------\nscallops&lt;-NEFSCspatial::Shellfish_Strata\nplot(scallops)\n\n\n\ntestGIS &lt;-st_read(\"~/Downloads/lab_notebook/data/Scallop_Rotational_Areas_20230419/Scallop_Rotational_Areas_20230411.shp\")\n\nReading layer `Scallop_Rotational_Areas_20230411' from data source \n  `/Users/rubykrasnow/Downloads/lab_notebook/data/Scallop_Rotational_Areas_20230419/Scallop_Rotational_Areas_20230411.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 6 features and 23 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -8274749 ymin: 4602998 xmax: -7333888 ymax: 5087139\nProjected CRS: WGS 84 / Pseudo-Mercator\n\nplot(testGIS[\"AREANAME\"], main=\"Scallop Management Areas\")\n\n\n\ntestGB &lt;- testGIS %&gt;% \n  filter(GARFO_ID != \"G000610\" & GARFO_ID != \"G000611\") %&gt;% \n  select(AREANAME, GARFO_ID, CFRPARA, FRCITE, FRDATE, SOURCE, COMMNAME, geometry) %&gt;% \n  mutate(NAME = recode(AREANAME, \"Area I Scallop Rotational Area\" = \"Area_I\", \n                       \"Area II Scallop Rotational Area\" = \"Area_II\", \n                       \"Nantucket Lightship North Scallop Rotational Area\" = \"NL_N\",\n                       \"Nantucket Lightship West Scallop Rotational Area\" = \"NL_W\"))\n\n\nplot(testGB[\"NAME\"], main=\"Georges Bank Scallop Management Areas\", key.pos=1, key.width = 0.1, key.length = 0.9)\n\n\n\n\nTesting and adjusting CRS:\n\n# Adjust CRS of the map of protected areas to match scallop survey CRS\n# st_crs(fish) - NAD83 (EPSG:4269)\n# st_crs(testGB) - WGS 84 / Pseudo-Mercator (EPSG: 3857)\ntestGB2&lt;- st_transform(testGB, crs = \"EPSG:4269\")\nst_crs(testGB2) # now they are both NAD83\n\nCoordinate Reference System:\n  User input: EPSG:4269 \n  wkt:\nGEOGCRS[\"NAD83\",\n    DATUM[\"North American Datum 1983\",\n        ELLIPSOID[\"GRS 1980\",6378137,298.257222101,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"geodetic latitude (Lat)\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"geodetic longitude (Lon)\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    USAGE[\n        SCOPE[\"Geodesy.\"],\n        AREA[\"North America - onshore and offshore: Canada - Alberta; British Columbia; Manitoba; New Brunswick; Newfoundland and Labrador; Northwest Territories; Nova Scotia; Nunavut; Ontario; Prince Edward Island; Quebec; Saskatchewan; Yukon. Puerto Rico. United States (USA) - Alabama; Alaska; Arizona; Arkansas; California; Colorado; Connecticut; Delaware; Florida; Georgia; Hawaii; Idaho; Illinois; Indiana; Iowa; Kansas; Kentucky; Louisiana; Maine; Maryland; Massachusetts; Michigan; Minnesota; Mississippi; Missouri; Montana; Nebraska; Nevada; New Hampshire; New Jersey; New Mexico; New York; North Carolina; North Dakota; Ohio; Oklahoma; Oregon; Pennsylvania; Rhode Island; South Carolina; South Dakota; Tennessee; Texas; Utah; Vermont; Virginia; Washington; West Virginia; Wisconsin; Wyoming. US Virgin Islands. British Virgin Islands.\"],\n        BBOX[14.92,167.65,86.45,-40.73]],\n    ID[\"EPSG\",4269]]\n\n\nMapping together:\n\n# Map of points within polygons\nggplot() + geom_sf(data = testGB2) + geom_sf(data = fish)\n\n\n\n# Intersection (first polygons, then points)\ninterCounts &lt;- st_intersects(testGB2, fish)\n\n# Add point count to each polygon\ntestGB2$count &lt;- lengths(interCounts)\n\n# Map of number of points within polygons\nggplot(testGB2) + geom_sf(aes(fill = count))\n\n\n\n\nIdentifying polygons containing points:\n\n# Intersection (first points, then polygons)\ninterID &lt;- st_intersects(fish, testGB2)\n\n# Adding column areaname with the name of\n# the areas containing the points\nfish$areaname &lt;- testGB2[unlist(interID), \"AREANAME\",\n                       drop = TRUE] # drop geometry\nfish"
  },
  {
    "objectID": "Resources/Papers.html",
    "href": "Resources/Papers.html",
    "title": "Relevant Papers",
    "section": "",
    "text": "Quantitative Fisheries (from Dr. Deyle)\n\n\n\n\n\n\n\nAuthor, year\nTitle\n\n\n\n\nOverholtz and Link (2009)\nA simulation model to explore the response of the Gulf of Maine food web to large-scale environmental and ecological changes\n\n\nJason Link et al. (2009)\nResponse of balanced network models to large-scale perturbation: Implications for evaluating the role of small pelagics in the Gulf of Maine\n\n\nRoss et al. (2021)\nProjecting regions of North Atlantic right whale, Eubalaena glacialis, habitat suitability in the Gulfof Maine for the year 2050\n\n\n\n\n\nFood webs & ecosystem-based management\n\n\n\n\n\n\n\nAuthor, year\nTitle\n\n\n\n\nJ. Link (2002)\nDoes food web theory work for marine ecosystems?\n\n\nTam et al. (2017)\nTowards ecosystem-based management: identifying operational food-web indicators for marine ecosystems\n\n\n\n\n\nAtlantic sea scallops\nSee the Scallop Resources page for more scallop-related literature\n\n\n\n\n\n\n\nAuthor, year\nTitle\n\n\n\n\nBethoney, Asci, and Stokesbury (2016)\nImplications of extremely high recruitment events into the US sea scallop fishery\n\n\nCooley et al. (2015)\nAn Integrated Assessment Model for Helping the United States Sea Scallop (Placopecten magellanicus) Fishery Plan Ahead for Ocean Acidification and Warming\n\n\nD. Hart (2003)\nYield- and biomass-per-recruit analysis for rotational fisheries, with an application to the Atlantic sea scallop\n\n\nD. R. Hart (2006)\nEffects of sea stars and crabs on sea scallop Placopecten magellanicus recruitment in the Mid-Atlantic Bight (USA)\n\n\nD. R. Hart and Chang (2022)\nEstimating natural mortality for Atlantic Sea scallops (Placopecten magellenicus) using a size-based stock assessment model\n\n\nD. R. Hart, Jacobson, and Tang (2013)\nTo split or not to split: Assessment of Georges Bank sea scallops in the presence of marine protected areas\n\n\nPousse et al. (2023)\nJuvenile Atlantic sea scallop, Placopecten magellanicus, energetic response to increased carbon dioxide and temperature changes\n\n\nRheuban et al. (2018)\nProjected impacts of future climate change, ocean acidification, and management on the US Atlantic sea scallop (Placopecten magellanicus) fishery\n\n\nShank, Hart, and Friedland (2012)\nPost-settlement predation by sea stars and crabs on the sea scallop in the Mid-Atlantic Bight\n\n\nStokesbury (2012)\nStock Definition and Recruitment: Implications for the U.S. Sea Scallop (Placopecten magellanicus) Fishery from 2003 to 2011\n\n\nTruesdell, Hart, and Chen (2016)\nEffects of spatial heterogeneity in growth and fishing effort on yield-per-recruit models: an application to the US Atlantic sea scallop fishery\n\n\nZang et al. (2023)\nEffects of warming and fishing on Atlantic sea scallop (Placopecten magellanicus) size structure in the Mid-Atlantic rotationally closed areas\n\n\n\n\n\nOther\n\n\n\n\n\n\n\n\nAuthor, year\nTitle\nNotes\n\n\n\n\nMaunder and Punt (2004)\nStandardizing catch and effort data: a review of recent approaches\nGood background on CPUE. Includes intro to catch data standardization, dealing with zeros and interactions, and selecting explanatory variables\n\n\nHsieh et al. (2008)\nSpatial analysis shows that fishing enhances the climatic sensitivity of marine fishes\nAnalyzed spatial area of occupancy and index of spatial heterogeneity, and changes in distribution from cold to warm period. Used linear regression and a variety of nonparametric tests\n\n\n\n\n\n\n\n\n\n\nAuthor, year\nTitle\n\n\n\n\nHamel et al. (2023)\nNatural mortality: Theory, estimation and application in fishery stock assessment models\n\n\nKenchington (2014)\nNatural mortality estimators for information-limited fisheries\n\n\n\n\n\n\n\n\nReferences\n\nBethoney, N. David, Samuel Asci, and Kevin D. E. Stokesbury. 2016. “Implications of Extremely High Recruitment Events into the US Sea Scallop Fishery.” Marine Ecology Progress Series 547 (April): 137–47. https://doi.org/10.3354/meps11666.\n\n\nCooley, Sarah R., Jennie E. Rheuban, Deborah R. Hart, Victoria Luu, David M. Glover, Jonathan A. Hare, and Scott C. Doney. 2015. “An Integrated Assessment Model for Helping the United States Sea Scallop (Placopecten Magellanicus) Fishery Plan Ahead for Ocean Acidification and Warming.” PLOS ONE 10 (5): e0124145. https://doi.org/10.1371/journal.pone.0124145.\n\n\nHamel, Owen S., James N. Ianelli, Mark N. Maunder, and André E. Punt. 2023. “Natural Mortality: Theory, Estimation and Application in Fishery Stock Assessment Models.” Fisheries Research 261 (May): 106638. https://doi.org/10.1016/j.fishres.2023.106638.\n\n\nHart, Deborah R. 2006. “Effects of Sea Stars and Crabs on Sea Scallop Placopecten Magellanicus Recruitment in the Mid-Atlantic Bight (USA).” Marine Ecology Progress Series 306: 209–21. https://www.jstor.org/stable/24869914.\n\n\nHart, Deborah R., and Jui-Han Chang. 2022. “Estimating Natural Mortality for Atlantic Sea Scallops (Placopecten Magellenicus) Using a Size-Based Stock Assessment Model.” Fisheries Research 254 (October): 106423. https://doi.org/10.1016/j.fishres.2022.106423.\n\n\nHart, Deborah R., Larry D. Jacobson, and Jiashen Tang. 2013. “To Split or Not to Split: Assessment of Georges Bank Sea Scallops in the Presence of Marine Protected Areas.” Fisheries Research, Marine Protected Areas as a Fisheries Management Tool, 144 (July): 74–83. https://doi.org/10.1016/j.fishres.2012.11.004.\n\n\nHart, Dvora. 2003. “Yield- and Biomass-Per-Recruit Analysis for Rotational Fisheries, with an Application to the Atlantic Sea Scallop (Placopecten Magellanicus).” Fishery Bulletin - National Oceanic and Atmospheric Administration 101 (January): 44–57. https://www.researchgate.net/publication/279700466_Yield-_and_biomass-per-recruit_analysis_for_rotational_fisheries_with_an_application_to_the_Atlantic_sea_scallop_Placopecten_magellanicus.\n\n\nHsieh, Chih-hao, Christian S Reiss, Roger P Hewitt, and George Sugihara. 2008. “Spatial Analysis Shows That Fishing Enhances the Climatic Sensitivity of Marine Fishes.” Canadian Journal of Fisheries and Aquatic Sciences 65 (5): 947–61. https://doi.org/10.1139/f08-017.\n\n\nKenchington, Trevor J. 2014. “Natural Mortality Estimators for Information-Limited Fisheries.” Fish and Fisheries 15 (4): 533–62. https://doi.org/10.1111/faf.12027.\n\n\nLink, J. 2002. “Does Food Web Theory Work for Marine Ecosystems?” Marine Ecology Progress Series 230: 1–9. https://doi.org/10.3354/meps230001.\n\n\nLink, Jason, Laurel Col, Vincent Guida, David Dow, John O’Reilly, Jack Green, William Overholtz, et al. 2009. “Response of Balanced Network Models to Large-Scale Perturbation: Implications for Evaluating the Role of Small Pelagics in the Gulf of Maine.” Ecological Modelling 220 (3): 351–69. https://doi.org/10.1016/j.ecolmodel.2008.10.009.\n\n\nMaunder, Mark N., and André E. Punt. 2004. “Standardizing Catch and Effort Data: A Review of Recent Approaches.” Fisheries Research, Models in Fisheries Research: GLMs, GAMS and GLMMs, 70 (2): 141–59. https://doi.org/10.1016/j.fishres.2004.08.002.\n\n\nOverholtz, William, and Jason Link. 2009. “A Simulation Model to Explore the Response of the Gulf of Maine Food Web to Large-Scale Environmental and Ecological Changes.” Ecological Modelling 220 (19): 2491–2502. https://doi.org/10.1016/j.ecolmodel.2009.06.034.\n\n\nPousse, Emilien, Matthew E. Poach, Dylan H. Redman, George Sennefelder, William Hubbard, Kristin Osborne, Daphne Munroe, et al. 2023. “Juvenile Atlantic Sea Scallop, Placopecten Magellanicus, Energetic Response to Increased Carbon Dioxide and Temperature Changes.” PLOS Climate 2 (2): e0000142. https://doi.org/10.1371/journal.pclm.0000142.\n\n\nRheuban, Jennie E., Scott C. Doney, Sarah R. Cooley, and Deborah R. Hart. 2018. “Projected Impacts of Future Climate Change, Ocean Acidification, and Management on the US Atlantic Sea Scallop (Placopecten Magellanicus) Fishery.” PLOS ONE 13 (9): e0203536. https://doi.org/10.1371/journal.pone.0203536.\n\n\nRoss, Camille H., Daniel E. Pendleton, Benjamin Tupper, David Brickman, Monica A. Zani, Charles A. Mayo, and Nicholas R. Record. 2021. “Projecting Regions of North Atlantic Right Whale, Eubalaena Glacialis, Habitat Suitability in the Gulf of Maine for the Year 2050.” Elementa: Science of the Anthropocene 9 (1): 00058. https://doi.org/10.1525/elementa.2020.20.00058.\n\n\nShank, Burton V., Deborah R. Hart, and Kevin D. Friedland. 2012. “Post-Settlement Predation by Sea Stars and Crabs on the Sea Scallop in the Mid-Atlantic Bight.” Marine Ecology Progress Series 468 (November): 161–77. https://doi.org/10.3354/meps09974.\n\n\nStokesbury, Kevin D. E. 2012. “Stock Definition and Recruitment: Implications for the u.s. Sea Scallop (Placopecten Magellanicus) Fishery from 2003 to 2011.” Reviews in Fisheries Science 20 (3): 154–64. https://doi.org/10.1080/10641262.2012.695816.\n\n\nTam, Jamie C., Jason S. Link, Axel G. Rossberg, Stuart I. Rogers, Philip S. Levin, Marie-Joëlle Rochet, Alida Bundy, et al. 2017. “Towards Ecosystem-Based Management: Identifying Operational Food-Web Indicators for Marine Ecosystems.” ICES Journal of Marine Science 74 (7): 2040–52. https://doi.org/10.1093/icesjms/fsw230.\n\n\nTruesdell, Samuel B., Deborah R. Hart, and Yong Chen. 2016. “Effects of Spatial Heterogeneity in Growth and Fishing Effort on Yield-Per-Recruit Models: An Application to the US Atlantic Sea Scallop Fishery.” ICES Journal of Marine Science 73 (4): 1062–73. https://doi.org/10.1093/icesjms/fsv238.\n\n\nZang, Z, R Ji, D R Hart, D Jin, C Chen, Y Liu, and C S Davis. 2023. “Effects of Warming and Fishing on Atlantic Sea Scallop (Placopecten Magellanicus) Size Structure in the Mid-Atlantic Rotationally Closed Areas.” ICES Journal of Marine Science, April, fsad063. https://doi.org/10.1093/icesjms/fsad063."
  },
  {
    "objectID": "Resources/ScallopResources.html",
    "href": "Resources/ScallopResources.html",
    "title": "Scallop Links",
    "section": "",
    "text": "General\n\n\n\nAuthor, year\nTitle\nNotes\n\n\n\n\nHart and Rago, 2006\nLong-Term Dynamics of U.S. Atlantic Sea Scallop Placopecten magellanicus Populations\nExcellent historical overview\n\n\nHart et al., 2013\nTo split or not to split: Assessment of Georges Bank sea scallops in the presence of marine protected areas\nRan CASA model (aggregate and split by area) on real data and SAMS simulated data\n\n\nLee et al., 2019\nResource Abundance, Fisheries Management, and Fishing Ports: The U.S. Atlantic Sea Scallop Fishery\nUses inverse-distance weighted available biomass index\n\n\nZang et al., 2022\nModeling Atlantic sea scallop (Placopecten magellanicus) scope for growth on the Northeast U.S. Shelf\nMATLAB scope for growth model available here\n\n\n\n\n\nRecruitment\n\n\n\nAuthor, year\nTitle\n\n\n\n\nHart, 2003\nYield- and biomass-per-recruit analysis for rotational fisheries, with an application to the Atlantic sea scallop\n\n\nTruesdell, 2015\nEffects of spatial heterogeneity in growth and fishing effort on yield-per-recruit models: An application to the US Atlantic sea scallop fishery\n\n\nStokesbury, 2012\nStock Definition and Recruitment: Implications for the U.S. Sea Scallop (Placopecten magellanicus) Fishery from 2003 to 2011\n\n\nBethoney, Asci, and Stokesbury, 2016\nImplications of extremely high recruitment events into the US sea scallop fishery\n\n\nBethoney and Stokesbury, 2019\nImplications of extremely high recruitment: crowding and reduced growth within spatial closures\n\n\n\n\n\nDistribution, population assessment, habitat, camera surveys\n\nAn Assessment of Juvenile and Adult Sea Scallop, Placopecten magellanicus, Distribution in the Northwest Atlantic using High-Resolution Still Imagery (Carey and Stokesbury, 2011)\nSea scallops exhibit strong local spatiotemporal structure associated with seabed stability and high flows (Harris, Adams, and Stokesbury, 2018)\nSpatial scaling of juvenile–adult associations in northwest Atlantic sea scallop Placopecten magellanicus populations (Carey, Wahle, and Stokesbury, 2013)\nFertilization success in scallop aggregations: reconciling model predictions and field measurements of density effects (Bayer et al., 2018)\nAn ensemble high-resolution projection of changes in the future habitat of American lobster and sea scallop in the Northeast US continental shelf (Tanaka et al., 2020)\nHow many sea scallops are there and why does it matter? (Stokesbury and Bethoney, 2020)\nMeasurement errors in body size of sea scallops (Placopecten magellanicus) and their effect on stock assessment models (Jacobson et al.,\n\n\n\nEstimation of Sea Scallop Abundance in Closed Areas of Georges Bank, USA (Stokesbury, 2002)\nSpatial distribution of the giant scallop Placopecten magellanicus in unharvested beds in the Baie des Chaleurs, Quebec (Stokesbury and Himmelman, 1993)\nBiological and physical variables associated with aggregations of the giant scallop Placopecten magellanicus (Stokesbury and Himmelman, 1995)\n\nIncludes discussion of predation\n\nMaine-specific\n\nHigh Densities of Juvenile Sea Scallop (Placopecten magellanicus) on Banks and Ledges in the Central Gulf of Maine (Stokesbury et al.,\n\n\n\nEstimating similarity in benthic communities over decades and in areas open and closed to fishing in the central Gulf of Maine, USA (Asci, Langton, and Stokesbury, 2018)\nDevelopment of a climate-niche model to evaluate spatiotemporal trends in Placopecten magellanicus distribution in the Gulf of Maine (Torre et al., 2019)\nA Spatiotemporal Evaluation of Atlantic Sea Scallop Placopecten magellanicus Habitat in the Gulf of Maine Using a Bioclimate Envelope Model (Torre, Tanaka, and Chen, 2018)\n\nShell height and meat weight\n\nSpatial and Temporal Variation in the Shell Height/Meat Weight Relationship of the Sea Scallop Placopecten magellanicus in the Georges Bank Fishery (Sarro and Stokesbury, 2009)\nVariability in the relationship between sea scallop shell height and meat weight (Rothschild et al., 2009)\n\n\n\n\nImpacts of warming, fishing, and OA\n\nEffects of warming and fishing on Atlantic sea scallop (Placopecten magellanicus) size structure in the Mid-Atlantic rotationally closed areas (Zang, 2023)\nProjected impacts of future climate change, ocean acidification, and management on the US Atlantic sea scallop fishery (Rheuban et al., 2018)\nImpacts of marine heat extremes on bivalves (Masanja et al., 2023)\nAn Integrated Assessment Model for Helping the United States Sea Scallop Fishery Plan Ahead for Ocean Acidification and Warming (Cooley, 2015)\nImpact of limited short-term sea scallop fishery on epibenthic community of Georges Bank closed areas (Stokesbury and Harris, 2006)\nExperimental, not modeling: Juvenile Atlantic sea scallop, Placopecten magellanicus, energetic response to increased carbon dioxide and temperature changes (Pousse et al., 2023)\n\n\n\nDispersal, settlement, connectivity, spawning\n\nImpact of larval behaviors on dispersal and connectivity of sea scallop larvae over the northeast U.S. shelf (Chen et al.,\n\n\n\nSpillover of sea scallops from rotational closures in the Mid-Atlantic Bight (Hart et al., 2020)\nIdentifying Spawning Events of the Sea Scallop Placopecten magellanicus on Georges Bank (Thompson, Inglis, and Stokesbury, 2014)\nModeling dispersal of sea scallop larvae on Georges Bank: The influence of depth-distribution, planktonic duration and spawning seasonality (Gilbert et al., 2010)\nDispersal and settlement of sea scallop larvae spawned in the fishery closed areas on Georges Bank (Tian et al., 2009)\nModeling the connectivity between sea scallop populations in the Middle Atlantic Bight and over Georges Bank (Tian et al., 2009)\nFisheries Closed Areas Strengthen Scallop Larval Settlement and Connectivity Among Closed Areas and Across International Open Fishing Grounds: A Model Study (Davies et al., 2015)\n\n\n\nNatural mortality\n\nNatural mortality estimators for information-limited fisheries (Kenchington, 2013)\nEstimating natural mortality for Atlantic Sea scallops (Placopecten magellenicus) using a size-based stock assessment model (Hart and Chang, 2022)\nNatural mortality: Theory, estimation and application in fishery stock assessment models (Hamel et al., 2023)\n\n\n\nPredation and other species interactions\n\nEffects of sea stars and crabs on sea scallop recruitment in the Mid-Atlantic Bight (Hart, 2006)\nPost-settlement predation by sea stars and crabs on the sea scallop in the Mid-Atlantic Bight (Shank, Hart, and Friedland, 2012)\nThe Effect of Increasing Habitat Complexity on Bay Scallop Survival in the Presence of Different Decapod Crustacean Predators (Carroll et al., 2014)\nEffect of closed areas on populations of sea star Asterias spp. on Georges Bank (Marino, Juanes, and Stokesbury, 2007)\nSpatio-temporal variations of sea star Asterias spp. distributions between sea scallop Placopecten magellanicus beds on Georges Bank (Marino, Juanes, and Stokesbury, 2009)\nIncidental fishing mortality may be responsible for the death of ten billion juvenile sea scallops in the mid-Atlantic (Stokesbury et al., 2011)\n\nMortality of sea scallops Placopecten magellanicus in the Mid-Atlantic Bight: Comment on Stokesbury et al.(Hart and Shank, 2011) - concluded it was actually crab predation\n\nExperimental\n\nSurvival analysis of tethered juvenile sea scallops Placopecten magellanicus in field experiments: Effects of predators, scallop size and density, site and season (Barbeau et al., 1994)\nBehavioral mechanisms of prey size selection by sea stars (Asterias Vulgaris) and crabs (cancer irroratus) preying on juvenile sea scallops (placopecten magellanicus) (Barbeau and Scheibling, 1994a)\nTemperature effects on predation of juvenile sea scallops [Placopecten magellanicus] by sea stars (Asterias vulgaris) and crabs (Cancer irroratus) (Barbeau and Scheibling, 1994b)\nDynamics of juvenile sea scallop (Placopecten magellanicus) and their predators in bottom seeding trials in Lunenburg Bay, Nova Scotia (Barbeau et al., 1996)\nBehavioural responses of predatory crabs and sea stars to varying density of juvenile sea scallops (Barbeau et al., 1998)\n\nEvaluating the interaction of the invasive tunicate Didemnum vexillum with the Atlantic sea scallop Placopecten magellanicus on open and closed fishing grounds of Georges Bank (Kaplan et al., 2017)\n\n\n\nData\n\nData & Visualization | HabCam \nhttp://webserver.smast.umassd.edu/lab_stokesbury/ssib.html\nMid-Atlantic Ocean Data Portal scallop visualization \nGoogle storage link to folders \nNortheast Ocean Data | Data Explorer\nData.gov Habitat Mapping Camera (HABCAM), NOAA Fisheries HABCAM | InPort\nData.gov Sea Scallop Survey, NOAA Fisheries Sea Scallop Survey | InPort\nData.gov BOEM Benthic Habitat Assessment\nData.gov Benthic Habitat Dataset\nData.gov population and biomass of United States sea scallop (Placopecten magellanicus) from an Atlantic Sea Scallop Integrated Assessment Model\n\n\n\nSurvey metadata, overviews, and methodology\n\nMethods for Image-based Surveys of Benthic Macroinvertebrates and Their Habitat Exemplified by the Drop Camera Survey for the Atlantic Sea Scallop (Bethoney and Stokesbury, 2018)\nA Cooperative High Precision Dredge Survey to Assess the Mid-Atlantic Sea Scallop Resource Area in 2019 and 2020: Final Report (Roman and Rudders, 2022)\nSMAST Sea scallop (Placopecten magellanicus) drop camera survey from 1999 to 2014 (Stokesbury et al, 2015)\nAverage (2003-2012) Presence/Abundance from SMAST Survey\nResults from the 2006 Maine sea scallop survey\n\n\n\nMaps and figures (of shellfish strata, closed areas, etc)\n\nFigs. 1 and 2\nPage 9\nFig. 1 (full-size here)\n\n\n\nOther\n\nCommercial Fisheries Research Foundation programs\n\nPiloting the Research Fleet Approach in the Atlantic Sea Scallop Fishery\nSea Scallop Image-Based Research Fleet\nAssessing Vulnerability of the Atlantic Sea Scallop Social-Ecological System in Northeast Waters\nPiloting a Novel Dredge Type to Reduce Bycatch and Improve Fuel efficiency in the Southern New England Scallop Fishery\nEstablishing Methods to Assess Sea Scallop Biological Condition in Relation to Wind Farm Development\nEngaging the Fishing Community to Understand Disease and Reproductive Dynamics of Atlantic Sea Scallop (using a scallop data collection smartphone app!)\n\nNOAA Fisheries/NEFSC & NEFMC links\n\nNortheast Industry-Funded Scallop Observers\nAtlantic Sea Scallop Research Track Working Group (and here)\nAtlantic Sea Scallop Management Overview (NOAA Fisheries)\nNew England Fishery Management Council - Sea Scallops\n\nVIMS Sea Scallop Research Program\n\nReports"
  },
  {
    "objectID": "Resources/EDM.html",
    "href": "Resources/EDM.html",
    "title": "Intro to EDM",
    "section": "",
    "text": "A dynamical system is a system whose state is uniquely specified by a set of variables (state variables) and whose behavior is described by predefined rules (Sayama 2015). The dynamical system evolves over time in the state space, which is the set of all possible values of the state variables. If a state space is continuous (i.e., the state variables are not restricted to discrete values) and finite-dimensional, the number of state variables defines the dimension of the dynamical system.\nIf a dynamical system is deterministic, future states of the system can be predicted from the past behavior of the system, even if the trajectories appear chaotic (Sugihara and May 1990). In a nonlinear system, interactions between variables are state-dependent: for example, the correlation between fish and zooplankton populations in the Baltic Sea changes sign depending on planktivore abundance, with two different ecosystem configurations (top-down vs. bottom-up forcing) on either side of a planktivore threshold (Casini et al. 2009).\n\nEmpirical dynamic modeling (EDM) uses time series data to analyze and forecast nonlinear systems, which are extremely common in the natural world (E. R. Deyle, May, et al. 2016). Ecologists classically model species interactions using a community matrix, a matrix of the partial derivatives (the Jacobian) of the system evaluated at equilibrium. The sign and magnitude of the coefficients in the matrix represent the direction and intensity, respectively, of the impact of a change in population of one species on the population of another. However, as with the Baltic Sea fish example, having a single matrix of coefficients does not suffice to describe a complex nonlinear system because the interaction between species can vary with the state of the ecosystem (E. R. Deyle, May, et al. 2016). Methods based on linear regression to analyze nonlinear ecological systems, while extremely valuable, have many weaknesses, including the inability to distinguish interactions between species from the effect of a shared driving variable like temperature (see the Moran Effect).\n\nIn EDM, the state of a dynamical system is a specific location in a multivariate coordinate space, or state space, whose coordinate axes are causally coupled ecosystem variables such as species abundance, temperature, resources, etc. The state of the system changes in time according to the rules/equations that describe the system dynamics, and this in turn traces out a trajectory. The collection of these time-series trajectories forms a geometric object called an attractor manifold, which describes empirically how variables relate to each other in time. (E. R. Deyle, May, et al. 2016)\n\nMotion on the attractor manifold can be projected onto a coordinate axis, forming a time series. On the other hand, we can use time series data to reconstruct the dynamics of the system in multidimensional state space, called attractor reconstruction (Chang, Ushio, and Hsieh 2017). In the real world, we often lack the necessary data (e.g., time series for cod, phytoplankton, and zooplankton) to reconstruct the dynamics of a system, and we likely do not even know all of the variables that dictate the state of the system. Using Takens’ theorem, we can use time-delay embedding to reconstruct a “shadow manifold” that preserves the essential dynamics of the original system.\nIntroduction to Empirical Dynamic Modeling (YouTube video)\nConstructing Empirical Dynamic Models: Takens’Theorem (YouTube video)\n\n\nSimplex projection is a non-parametric analysis in state space used to determine the optimal embedding dimension, \\(E\\), of a system. This is important for future EDM techniques and can offer insight into the dimensionality (and complexity) of a given system. Papers that provide helpful and more technically rigorous descriptions of simplex projection include Ye, Beamish, et al. (2015), Chang, Ushio, and Hsieh (2017), Sugihara and May (1990), and the vignette for the R package rEDM, which also describes how to perform the analysis in R. Roughly, simplex projection is done as follows:\n\nChoose an embedding dimension, \\(E\\)\nUse the \\(E+1\\) nearest neighbors of the target point in \\(E\\)-dimensional space to enclose the predictee in a minimal polygon (simplex)\nUse the future position of the simplex to predict the future position of the predictee\n\nTake the weighted average of the forward evolutions of the neighboring points (the average scaled by Euclidean distance of the nearest neighbor to the predictee)\n\nEvaluate the predictive skill of the simplex projection, such as by computing the correlation coefficient \\(\\rho\\) between the forecasted and observed results.\nRepeat the process with different values of \\(E\\) to determine which \\(E\\) results in the highest predictive skill, indicating the optimal embedding dimension\n\n**NOTES **\n\n\\(E\\) is not necessarily the same as the true dimension of the system, \\(D\\), or the number of variables being analyzed (e.g., number of species in a trophic web), but it is bounded such that \\(E&lt;2D+1\\)\nIt is sometimes helpful to take the first differences in a target variable to distinguish meaningful prediction ability arising from the system dynamics from the statistical prediction resulting from autocorrelation. For example, E. Deyle et al. (2018) used \\(ΔLPUE(t) = LPUE(t + 1) − LPUE(t)\\) rather than simply \\(LPUE(t)\\).\n\n\n\n\nS-map analysis can be used to distinguish nonlinear dynamical systems from linear stochastic systems and identify the degree of state-dependency of a system (Sugihara 1994).S-mapping is a forecasting method that uses locally weighted multivariate linear regressions calculated as the system moves along its attractor. Rather than using only nearby points, S-maps uses the entire library of points on the attractor, where points are given an exponentially decaying weight based on their distance from the target point.\nHelpful explanations of how S-mapping works can be found in the Methods sections of (Glaser et al. 2011),(E. R. Deyle, May, et al. 2016) and (E. Deyle et al. 2018), as well as in (Chang, Ushio, and Hsieh 2017).\n\nS-map analysis is a locally weighted linear regression performed under the state space associated with a weighting function in the form of an exponential decay kernel, \\(w(d) = e^{(−θ d/\\bar{d})}\\). Here, \\(d\\) is the distance between the predictee and each library point, and \\(\\bar{d}\\) is the mean distance of all paired library points. The parameter θ controls the degree of state dependency. If θ = 0, all library points have the same weight regardless of the local state of the predictee; mathematically, this model reduces to a linear autoregressive model. In contrast, if θ &gt; 0, the forecast given by the S-map depends on the local state of the predictee, and thus produces locally different fittings. Therefore, by comparing the performance of equivalent linear (θ = 0) and nonlinear (θ &gt; 0) S-map models, one can distinguish nonlinear dynamical systems from linear stochastic systems. (Chang, Ushio, and Hsieh 2017)\n\nWe can quantify the state-dependency of the system by finding the improvement in prediction skill of the nonlinear model compared to a linear model, \\(Δ\\rho=\\rho_\\theta-\\rho_{(\\theta=0)}\\). The statistical significance of S-map results can be analyzed by generating a randomized version of the time series that maintains the fundamental statistical properties of the real data set (like autocorrelation), but is otherwise completely random. Performing S-map analysis on a large sample of such randomly-generated series will generate a null distribution of the S-map predictability \\(\\rho\\) and \\(Δ\\rho\\). Thus, we can find the probability of obtaining the \\(\\rho\\) and \\(Δ\\rho\\) values from the real data if the underlying nonlinear dynamics were not present.\n\n\n\nState Space Reconstruction: Convergent Cross Mapping (YouTube video)\nCCM can detect causal linkages between time series and distinguish such causality from correlation arising from a shared environmental driver. (Sugihara et al. 2012) provides a comprehensive description of how CCM works, with general explanations also available in (Chang, Ushio, and Hsieh 2017), (Ye, Deyle, et al. 2015),(E. R. Deyle et al. 2013), and (E. Deyle et al. 2018), among others.\nIn essence, CCM measures the extent to which the historical record of \\(Y\\)’s values (the shadow manifold \\(M_Y\\) built from \\(Y\\) and the appropriate number of time lags) can be used to predict states of \\(X\\). If \\(X\\) causes \\(Y\\), information about the state of \\(X\\) can be recovered from \\(M_Y\\) and having a more detailed \\(M_Y\\) (bigger library size = a denser manifold) increases the prediction skill of \\(X\\). Therefore, significant convergence when using \\(M_Y\\) to predict \\(X\\) (i.e., \\(Y\\) crossmap \\(X\\)) indicates causality in the reverse direction, \\(X\\Rightarrow Y\\). For a stochastic forcing variable \\(X\\), the current state of \\(Y\\) cannot be inferred from values of \\(X\\), so a manifold reconstructed from lags of \\(X\\) will not reliably estimate \\(Y\\); i.e., \\(X\\) crossmap \\(Y\\) will fail to converge.\nHere is a collection of papers that I have read that used (non-spatial) CCM to identify causality in complex ecosystems:\n\n\n\n\n\n\n\n\nAuthor, year\nTitle\nNotes\n\n\n\n\nSugihara et al. (2012)\nDetecting Causality in Complex Ecosystems\nThe must-read paper describing CCM! Describes different possibilities: bidirectional causality via functional coupling, unidirectional causality, and more complex models. Supplementary material is also helpful, esp. Box S1 (pg. 37). Examples included: (1) Bidirectional coupling b/w Didinium (predator) and Paramecium (prey), and (2) Anchovy, sardine, and SST: species aren’t coupled to each other, but weakly forced by same envi. driver\n\n\nE. R. Deyle et al. (2013)\nPredicting climate effects on Pacific sardine\nBuilds off Sugihara et al. (2012), which established that sardine pop. is state-dependent and temp does impact sardines. Uses multivariate EDM first on toy Ricker model, then on real data to predict the effect of changes in SST on sardines, explore possible temp scenarios\n\n\nYe, Deyle, et al. (2015)\nDistinguishing time-delayed causal interactions using convergent cross mapping\nOvercoming “generalized synchrony”: the problem that CCM can’t distinguish b/w very strong unidirectional forcing and bidirectional causality bc strong unidirectional forcing by X on Y can make the system (X and Y) collapse to just the dynamics of X, so CCM is observed in both directions. Considering different time lags for CCM uncovers asynchrony when there is a detectable lag b/w cause and effect. See Fig. 1. Cool!\n\n\nTsonis et al. (2015)\nDynamical evidence for causality between galactic cosmic rays and interannual variation in global temperature\nUses S-maps and CCM to show that cosmic rays are coupled to global temp, but aren’t measurably contributing to global warming. Also see Ye, Sugihara, et al. (2015)\n\n\nE. R. Deyle, Maher, et al. (2016)\nGlobal environmental drivers of influenza\nExample of when magnitude of cross-map skill shouldn’t be used as indicator of the strength of causal effect. Includes multivariate EDM scenario exploration. Used permutation test to distinguish driving effects of seasonal variables on seasonal influenza from shared seasonality.\n\n\nMcGowan et al. (2017)\nPredicting coastal algal blooms in southern California\nIntegrating nonlinear endogenous (deterministic) dynamics with relevant (stochastic) environmental variables gives mechanistic insight into historic red tide blooms and can produce out-of-sample forecasts of a recent red tide in La Jolla.\n\n\nChang, Ushio, and Hsieh (2017)\nEmpirical dynamic modeling for beginners\nGood overview of simplex projection, S-maps, and CCM, applied to real-world examples. Supplementary code can’t be run as provided, but overall a very useful article."
  },
  {
    "objectID": "Resources/EDM.html#simplex-projection",
    "href": "Resources/EDM.html#simplex-projection",
    "title": "Intro to EDM",
    "section": "",
    "text": "Simplex projection is a non-parametric analysis in state space used to determine the optimal embedding dimension, \\(E\\), of a system. This is important for future EDM techniques and can offer insight into the dimensionality (and complexity) of a given system. Papers that provide helpful and more technically rigorous descriptions of simplex projection include Ye, Beamish, et al. (2015), Chang, Ushio, and Hsieh (2017), Sugihara and May (1990), and the vignette for the R package rEDM, which also describes how to perform the analysis in R. Roughly, simplex projection is done as follows:\n\nChoose an embedding dimension, \\(E\\)\nUse the \\(E+1\\) nearest neighbors of the target point in \\(E\\)-dimensional space to enclose the predictee in a minimal polygon (simplex)\nUse the future position of the simplex to predict the future position of the predictee\n\nTake the weighted average of the forward evolutions of the neighboring points (the average scaled by Euclidean distance of the nearest neighbor to the predictee)\n\nEvaluate the predictive skill of the simplex projection, such as by computing the correlation coefficient \\(\\rho\\) between the forecasted and observed results.\nRepeat the process with different values of \\(E\\) to determine which \\(E\\) results in the highest predictive skill, indicating the optimal embedding dimension\n\n**NOTES **\n\n\\(E\\) is not necessarily the same as the true dimension of the system, \\(D\\), or the number of variables being analyzed (e.g., number of species in a trophic web), but it is bounded such that \\(E&lt;2D+1\\)\nIt is sometimes helpful to take the first differences in a target variable to distinguish meaningful prediction ability arising from the system dynamics from the statistical prediction resulting from autocorrelation. For example, E. Deyle et al. (2018) used \\(ΔLPUE(t) = LPUE(t + 1) − LPUE(t)\\) rather than simply \\(LPUE(t)\\)."
  },
  {
    "objectID": "Resources/EDM.html#s-map-analysis",
    "href": "Resources/EDM.html#s-map-analysis",
    "title": "Intro to EDM",
    "section": "",
    "text": "S-map analysis can be used to distinguish nonlinear dynamical systems from linear stochastic systems and identify the degree of state-dependency of a system (Sugihara 1994).S-mapping is a forecasting method that uses locally weighted multivariate linear regressions calculated as the system moves along its attractor. Rather than using only nearby points, S-maps uses the entire library of points on the attractor, where points are given an exponentially decaying weight based on their distance from the target point.\nHelpful explanations of how S-mapping works can be found in the Methods sections of (Glaser et al. 2011),(E. R. Deyle, May, et al. 2016) and (E. Deyle et al. 2018), as well as in (Chang, Ushio, and Hsieh 2017).\n\nS-map analysis is a locally weighted linear regression performed under the state space associated with a weighting function in the form of an exponential decay kernel, \\(w(d) = e^{(−θ d/\\bar{d})}\\). Here, \\(d\\) is the distance between the predictee and each library point, and \\(\\bar{d}\\) is the mean distance of all paired library points. The parameter θ controls the degree of state dependency. If θ = 0, all library points have the same weight regardless of the local state of the predictee; mathematically, this model reduces to a linear autoregressive model. In contrast, if θ &gt; 0, the forecast given by the S-map depends on the local state of the predictee, and thus produces locally different fittings. Therefore, by comparing the performance of equivalent linear (θ = 0) and nonlinear (θ &gt; 0) S-map models, one can distinguish nonlinear dynamical systems from linear stochastic systems. (Chang, Ushio, and Hsieh 2017)\n\nWe can quantify the state-dependency of the system by finding the improvement in prediction skill of the nonlinear model compared to a linear model, \\(Δ\\rho=\\rho_\\theta-\\rho_{(\\theta=0)}\\). The statistical significance of S-map results can be analyzed by generating a randomized version of the time series that maintains the fundamental statistical properties of the real data set (like autocorrelation), but is otherwise completely random. Performing S-map analysis on a large sample of such randomly-generated series will generate a null distribution of the S-map predictability \\(\\rho\\) and \\(Δ\\rho\\). Thus, we can find the probability of obtaining the \\(\\rho\\) and \\(Δ\\rho\\) values from the real data if the underlying nonlinear dynamics were not present."
  },
  {
    "objectID": "Resources/EDM.html#convergent-cross-mapping-ccm",
    "href": "Resources/EDM.html#convergent-cross-mapping-ccm",
    "title": "Intro to EDM",
    "section": "",
    "text": "State Space Reconstruction: Convergent Cross Mapping (YouTube video)\nCCM can detect causal linkages between time series and distinguish such causality from correlation arising from a shared environmental driver. (Sugihara et al. 2012) provides a comprehensive description of how CCM works, with general explanations also available in (Chang, Ushio, and Hsieh 2017), (Ye, Deyle, et al. 2015),(E. R. Deyle et al. 2013), and (E. Deyle et al. 2018), among others.\nIn essence, CCM measures the extent to which the historical record of \\(Y\\)’s values (the shadow manifold \\(M_Y\\) built from \\(Y\\) and the appropriate number of time lags) can be used to predict states of \\(X\\). If \\(X\\) causes \\(Y\\), information about the state of \\(X\\) can be recovered from \\(M_Y\\) and having a more detailed \\(M_Y\\) (bigger library size = a denser manifold) increases the prediction skill of \\(X\\). Therefore, significant convergence when using \\(M_Y\\) to predict \\(X\\) (i.e., \\(Y\\) crossmap \\(X\\)) indicates causality in the reverse direction, \\(X\\Rightarrow Y\\). For a stochastic forcing variable \\(X\\), the current state of \\(Y\\) cannot be inferred from values of \\(X\\), so a manifold reconstructed from lags of \\(X\\) will not reliably estimate \\(Y\\); i.e., \\(X\\) crossmap \\(Y\\) will fail to converge.\nHere is a collection of papers that I have read that used (non-spatial) CCM to identify causality in complex ecosystems:\n\n\n\n\n\n\n\n\nAuthor, year\nTitle\nNotes\n\n\n\n\nSugihara et al. (2012)\nDetecting Causality in Complex Ecosystems\nThe must-read paper describing CCM! Describes different possibilities: bidirectional causality via functional coupling, unidirectional causality, and more complex models. Supplementary material is also helpful, esp. Box S1 (pg. 37). Examples included: (1) Bidirectional coupling b/w Didinium (predator) and Paramecium (prey), and (2) Anchovy, sardine, and SST: species aren’t coupled to each other, but weakly forced by same envi. driver\n\n\nE. R. Deyle et al. (2013)\nPredicting climate effects on Pacific sardine\nBuilds off Sugihara et al. (2012), which established that sardine pop. is state-dependent and temp does impact sardines. Uses multivariate EDM first on toy Ricker model, then on real data to predict the effect of changes in SST on sardines, explore possible temp scenarios\n\n\nYe, Deyle, et al. (2015)\nDistinguishing time-delayed causal interactions using convergent cross mapping\nOvercoming “generalized synchrony”: the problem that CCM can’t distinguish b/w very strong unidirectional forcing and bidirectional causality bc strong unidirectional forcing by X on Y can make the system (X and Y) collapse to just the dynamics of X, so CCM is observed in both directions. Considering different time lags for CCM uncovers asynchrony when there is a detectable lag b/w cause and effect. See Fig. 1. Cool!\n\n\nTsonis et al. (2015)\nDynamical evidence for causality between galactic cosmic rays and interannual variation in global temperature\nUses S-maps and CCM to show that cosmic rays are coupled to global temp, but aren’t measurably contributing to global warming. Also see Ye, Sugihara, et al. (2015)\n\n\nE. R. Deyle, Maher, et al. (2016)\nGlobal environmental drivers of influenza\nExample of when magnitude of cross-map skill shouldn’t be used as indicator of the strength of causal effect. Includes multivariate EDM scenario exploration. Used permutation test to distinguish driving effects of seasonal variables on seasonal influenza from shared seasonality.\n\n\nMcGowan et al. (2017)\nPredicting coastal algal blooms in southern California\nIntegrating nonlinear endogenous (deterministic) dynamics with relevant (stochastic) environmental variables gives mechanistic insight into historic red tide blooms and can produce out-of-sample forecasts of a recent red tide in La Jolla.\n\n\nChang, Ushio, and Hsieh (2017)\nEmpirical dynamic modeling for beginners\nGood overview of simplex projection, S-maps, and CCM, applied to real-world examples. Supplementary code can’t be run as provided, but overall a very useful article."
  },
  {
    "objectID": "exploringR.html",
    "href": "exploringR.html",
    "title": "Exploring",
    "section": "",
    "text": "#Summary of data analysis thus far\n#Last updated: June 23, 2023\n\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(rEDM)\n\ndat_len&lt;- read.csv(\"data/22564_UNION_FSCS_SVLEN2022.csv\")\ndat_cat &lt;- read.csv(\"data/22564_UNION_FSCS_SVCAT2022.csv\")\ndat_bio &lt;- read.csv(\"data/22564_UNION_FSCS_SVBIO2022.csv\", quote = \"\")\ncruises &lt;- read.csv(\"data/22564_SVDBS_CRUISES2022.csv\")\ndf_stations &lt;- read.csv(\"data/22564_UNION_FSCS_SVSTA2022.csv\")\ndf_strata &lt;- read.csv(\"data/newSVDBS_SVMSTRATA.csv\")\n\n# Cruises & stations ---------------------------------------------------- \n\ncruises &lt;- cruises %&gt;%\n  select(c(\"CRUISE6\",\"SEASON\",\"YEAR\")) %&gt;%\n  mutate(CRUISE6 = as.factor(CRUISE6), .keep=\"unused\")\n\ndf_stations &lt;- df_stations %&gt;% \n  mutate(STATION = as.numeric(STATION), YEAR = EST_YEAR) %&gt;% \n  select(c(\"CRUISE6\",\"CRUISE\",\"STRATUM\", \"TOW\",\"STATION\",\"ID\",\"AREA\",\"SVVESSEL\",\"SVGEAR\",\n     \"BEGIN_EST_TOWDATE\",\"YEAR\",\"SETDEPTH\", \"AVGDEPTH\", \"BEGLAT\", \"BEGLON\"))\n\ndf_stations &lt;- df_stations %&gt;% \n  mutate(BEGIN_EST_TOWDATE = lubridate::dmy(BEGIN_EST_TOWDATE)) %&gt;% \n  mutate(YEAR = year(BEGIN_EST_TOWDATE)) %&gt;% \n  mutate(TOW = as.integer(TOW))\n\n# Length ------------------------------------------------------------------\n\nhead(dat_len)\n\n  CRUISE6 CRUISE STRATUM TOW STATION STATUS_CODE                 ID SVSPP\n1  197703    177   06370   1       1          10 197703063700010001   401\n2  197703    177   06370   1       1          10 197703063700010001   401\n3  197703    177   06370   1       1          10 197703063700010001   401\n4  197703    177   06370   1       1          10 197703063700010001   401\n5  197703    177   06370   2       2          10 197703063700020002   401\n6  197703    177   06370   2       2          10 197703063700020002   401\n  CATCHSEX LENGTH EXPNUMLEN                        SCIENTIFIC_NAME\n1        0    6.7         1 Placopecten magellanicus (sea scallop)\n2        0    8.3         1 Placopecten magellanicus (sea scallop)\n3        0    8.7         1 Placopecten magellanicus (sea scallop)\n4        0   10.3         1 Placopecten magellanicus (sea scallop)\n5        0    5.7         1 Placopecten magellanicus (sea scallop)\n6        0    6.7         2 Placopecten magellanicus (sea scallop)\n  LENGTH_COMMENT\n1               \n2               \n3               \n4               \n5               \n6               \n\nstr(dat_len) #543666 observations of 13 vars\n\n'data.frame':   543666 obs. of  13 variables:\n $ CRUISE6        : int  197703 197703 197703 197703 197703 197703 197703 197703 197703 197703 ...\n $ CRUISE         : int  177 177 177 177 177 177 177 177 177 177 ...\n $ STRATUM        : chr  \"06370\" \"06370\" \"06370\" \"06370\" ...\n $ TOW            : int  1 1 1 1 2 2 3 3 1 1 ...\n $ STATION        : int  1 1 1 1 2 2 3 3 4 4 ...\n $ STATUS_CODE    : int  10 10 10 10 10 10 10 10 10 10 ...\n $ ID             : chr  \"197703063700010001\" \"197703063700010001\" \"197703063700010001\" \"197703063700010001\" ...\n $ SVSPP          : int  401 401 401 401 401 401 401 401 401 401 ...\n $ CATCHSEX       : int  0 0 0 0 0 0 0 0 0 0 ...\n $ LENGTH         : num  6.7 8.3 8.7 10.3 5.7 6.7 9.7 10.7 10.3 11.7 ...\n $ EXPNUMLEN      : int  1 1 1 1 1 2 1 1 1 1 ...\n $ SCIENTIFIC_NAME: chr  \"Placopecten magellanicus (sea scallop)\" \"Placopecten magellanicus (sea scallop)\" \"Placopecten magellanicus (sea scallop)\" \"Placopecten magellanicus (sea scallop)\" ...\n $ LENGTH_COMMENT : chr  \"\" \"\" \"\" \"\" ...\n\nscallopLen &lt;- dat_len %&gt;%\n  filter(SCIENTIFIC_NAME == \"Placopecten magellanicus (sea scallop)\") %&gt;% \n     mutate(NAME = recode(SCIENTIFIC_NAME, \"Placopecten magellanicus (sea scallop)\" = \"scallop\")) #shorten for readability\n                           \n#If interested in clappers also:\n# SCIENTIFIC_NAME == \"Placopecten magellanicus (sea scallop clapper)\") %&gt;%  #filter to only scallops\n# recode(SCIENTIFIC_NAME, \"Placopecten magellanicus (sea scallop clapper)\" = \"clapper\")\n      \n#All have sex = 0, means sex unknown/not recorded\n#SVSPP is species, either 401 (scallop) or 400 (clapper), redundant to name column\n#So we can remove unnecessary variables\n\nscallopLen &lt;- scallopLen %&gt;% \n  select(-c(\"CATCHSEX\", \"STATUS_CODE\", \"SVSPP\", \"SCIENTIFIC_NAME\"))\n\nscallopLen &lt;- scallopLen %&gt;%\n  mutate(CRUISE6 = as.factor(CRUISE6),\n         CRUISE = as.factor(CRUISE),\n         STATION = as.numeric(STATION),\n         .keep = \"unused\")\n\nsummarise_all(scallopLen,n_distinct)\n\n  CRUISE6 CRUISE STRATUM TOW STATION    ID LENGTH EXPNUMLEN LENGTH_COMMENT NAME\n1      47     49     100 138     692 15629   1638      1127              1    1\n\nscallopLen &lt;- left_join(scallopLen, cruises, by=\"CRUISE6\")\n\nscallopLen &lt;- scallopLen %&gt;%\n  mutate(YEAR = as.numeric(YEAR)) %&gt;%\n  filter(as.numeric(STRATUM) &gt; 5999) #shellfish strata start with 6\n\nlen &lt;- left_join(scallopLen, df_stations)\n\n# Catch ----------------------------------------------------------\n\nscallopCat &lt;- dat_cat %&gt;%\n  filter(SCIENTIFIC_NAME == \"Placopecten magellanicus (sea scallop)\") %&gt;% \n  mutate(NAME = recode(SCIENTIFIC_NAME, \"Placopecten magellanicus (sea scallop)\" = \"scallop\"))\n\n# scallopCat &lt;- scallopCat %&gt;% \n#   select(-c(\"CATCHSEX\", \"STATUS_CODE\", \"SVSPP\", \"SCIENTIFIC_NAME\"))\n\nsummarise_all(scallopLen,n_distinct)\n\n  CRUISE6 CRUISE STRATUM TOW STATION    ID LENGTH EXPNUMLEN LENGTH_COMMENT NAME\n1      47     49      81 138     628 15430   1638      1119              1    1\n  SEASON YEAR\n1      3   45\n\nscallopCat &lt;- scallopCat %&gt;%\n  mutate(CRUISE6 = as.factor(CRUISE6),\n         CRUISE = as.factor(CRUISE),\n         STATION = as.numeric(STATION),\n         .keep = \"unused\")\n\nscallopCat &lt;- left_join(scallopCat, cruises, by=\"CRUISE6\")\n\n#shellfish strata start with 6\n scallopCat &lt;-  scallopCat %&gt;%\n   filter(as.numeric(STRATUM) &gt; 5999)\n\nstr(scallopCat)\n\n'data.frame':   15433 obs. of  16 variables:\n $ CRUISE6        : Factor w/ 47 levels \"197703\",\"197708\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ CRUISE         : Factor w/ 49 levels \"177\",\"200107\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ STRATUM        : chr  \"06370\" \"06370\" \"06370\" \"06380\" ...\n $ TOW            : int  1 2 3 1 4 5 1 1 2 1 ...\n $ STATION        : num  1 2 3 4 5 6 8 13 14 15 ...\n $ STATUS_CODE    : int  10 10 10 10 10 10 10 10 10 10 ...\n $ ID             : chr  \"197703063700010001\" \"197703063700020002\" \"197703063700030003\" \"197703063800010004\" ...\n $ SVSPP          : int  401 401 401 401 401 401 401 401 401 401 ...\n $ CATCHSEX       : int  0 0 0 0 0 0 0 0 0 0 ...\n $ EXPCATCHNUM    : int  4 3 2 4 12 22 1 2 1897 22 ...\n $ EXPCATCHWT     : num  0.3 0.1 0.3 0.9 1.7 ...\n $ SCIENTIFIC_NAME: chr  \"Placopecten magellanicus (sea scallop)\" \"Placopecten magellanicus (sea scallop)\" \"Placopecten magellanicus (sea scallop)\" \"Placopecten magellanicus (sea scallop)\" ...\n $ CATCH_COMMENT  : chr  \"\" \"\" \"\" \"\" ...\n $ NAME           : chr  \"scallop\" \"scallop\" \"scallop\" \"scallop\" ...\n $ SEASON         : chr  \"SPRING\" \"SPRING\" \"SPRING\" \"SPRING\" ...\n $ YEAR           : int  1977 1977 1977 1977 1977 1977 1977 1977 1977 1977 ...\n\nsummarise_all(scallopCat,n_distinct)\n\n  CRUISE6 CRUISE STRATUM TOW STATION STATUS_CODE    ID SVSPP CATCHSEX\n1      47     49      81 138     628           1 15433     1        1\n  EXPCATCHNUM EXPCATCHWT SCIENTIFIC_NAME CATCH_COMMENT NAME SEASON YEAR\n1        2035       4923               1           202    1      3   45\n\nas_tibble(scallopCat)\n\n# A tibble: 15,433 × 16\n   CRUISE6 CRUISE STRATUM   TOW STATION STATUS_CODE ID     SVSPP CATCH…¹ EXPCA…²\n   &lt;fct&gt;   &lt;fct&gt;  &lt;chr&gt;   &lt;int&gt;   &lt;dbl&gt;       &lt;int&gt; &lt;chr&gt;  &lt;int&gt;   &lt;int&gt;   &lt;int&gt;\n 1 197703  177    06370       1       1          10 19770…   401       0       4\n 2 197703  177    06370       2       2          10 19770…   401       0       3\n 3 197703  177    06370       3       3          10 19770…   401       0       2\n 4 197703  177    06380       1       4          10 19770…   401       0       4\n 5 197703  177    06370       4       5          10 19770…   401       0      12\n 6 197703  177    06370       5       6          10 19770…   401       0      22\n 7 197703  177    06420       1       8          10 19770…   401       0       1\n 8 197703  177    06500       1      13          10 19770…   401       0       2\n 9 197703  177    06500       2      14          10 19770…   401       0    1897\n10 197703  177    06520       1      15          10 19770…   401       0      22\n# … with 15,423 more rows, 6 more variables: EXPCATCHWT &lt;dbl&gt;,\n#   SCIENTIFIC_NAME &lt;chr&gt;, CATCH_COMMENT &lt;chr&gt;, NAME &lt;chr&gt;, SEASON &lt;chr&gt;,\n#   YEAR &lt;int&gt;, and abbreviated variable names ¹​CATCHSEX, ²​EXPCATCHNUM\n\ndata.frame(table(scallopCat$YEAR))\n\n   Var1 Freq\n1  1977  244\n2  1978  287\n3  1979  240\n4  1980  317\n5  1981  268\n6  1982  346\n7  1983  424\n8  1984  387\n9  1985  433\n10 1986  392\n11 1987  472\n12 1988  487\n13 1989  367\n14 1990  389\n15 1991  395\n16 1992  367\n17 1993  404\n18 1994  423\n19 1995  431\n20 1996  391\n21 1997  432\n22 1998  470\n23 1999  354\n24 2000  423\n25 2001  483\n26 2002  461\n27 2003  422\n28 2004  510\n29 2005  482\n30 2006  490\n31 2007  534\n32 2008  423\n33 2009  382\n34 2010  440\n35 2011  289\n36 2012  201\n37 2013  181\n38 2014  119\n39 2015  170\n40 2016  140\n41 2017  120\n42 2018  149\n43 2019  112\n44 2021   76\n45 2022  106\n\ncat &lt;- left_join(scallopCat, df_stations)\n\ncatTest &lt;- cat %&gt;% \n  group_by(STRATUM) %&gt;% \n  summarise(years=n_distinct(YEAR))\n\nlenTest &lt;- len %&gt;% \n  group_by(STRATUM) %&gt;% \n  summarise(years=n_distinct(YEAR))\n\n\n\n# Predators ---------------------------------------------------------------\n\nspeciesLen &lt;- dat_len %&gt;% \n  group_by(SCIENTIFIC_NAME) %&gt;% \n  summarise(avg = mean(LENGTH))\n\nspeciesCat &lt;- dat_cat %&gt;% \n  group_by(SCIENTIFIC_NAME) %&gt;% \n  summarise(count = n_distinct(ID))\n\n\n########## crabs\n# crabsLen &lt;- dat_len %&gt;% \n#   filter(SCIENTIFIC_NAME==\"Cancer borealis (Jonah crab)\" | \n#            SCIENTIFIC_NAME ==\"Cancer irroratus (Atlantic rock crab)\") %&gt;%\n#   mutate(CRUISE6 = as.factor(CRUISE6),\n#          CRUISE = as.factor(CRUISE),\n#          STATION = as.numeric(STATION),\n#          .keep = \"unused\")\n# \n# crabsLen &lt;- left_join(crabsLen, cruises, by=\"CRUISE6\")\n# crabsTest &lt;- crabsLen %&gt;% \n#   group_by(STRATUM) %&gt;% \n#   summarise(years=n_distinct(YEAR))\n# \n# crabsCat &lt;- dat_cat %&gt;% \n#   filter(SCIENTIFIC_NAME==\"Cancer borealis (Jonah crab)\" | \n#            SCIENTIFIC_NAME ==\"Cancer irroratus (Atlantic rock crab)\") %&gt;%\n#   mutate(CRUISE6 = as.factor(CRUISE6),\n#          CRUISE = as.factor(CRUISE),\n#          STATION = as.numeric(STATION),\n#          .keep = \"unused\")\n# \n# crabsCat &lt;- left_join(crabsCat, cruises, by=\"CRUISE6\")\n# crabsTest2 &lt;- crabsCat %&gt;% \n#   group_by(STRATUM) %&gt;% \n#   summarise(years=n_distinct(YEAR))\n\n\n########## Astropecten\n\n# astroLen &lt;- dat_len %&gt;% \n#   filter(SCIENTIFIC_NAME==\"Astropecten\" | #none\n#         SCIENTIFIC_NAME ==\"Astropecten articulatus (royal sea star)\") %&gt;%  #none\n#   mutate(CRUISE6 = as.factor(CRUISE6),\n#          CRUISE = as.factor(CRUISE),\n#          STATION = as.numeric(STATION),\n#          .keep = \"unused\")\n\nastroCat &lt;- dat_cat %&gt;% \n  filter(SCIENTIFIC_NAME==\"Astropecten\" |\n           SCIENTIFIC_NAME ==\"Astropecten articulatus (royal sea star)\") %&gt;%\n  mutate(CRUISE6 = as.factor(CRUISE6),\n         CRUISE = as.factor(CRUISE),\n         STATION = as.numeric(STATION),\n         .keep = \"unused\")\n\nastroCat &lt;- left_join(astroCat, cruises, by=\"CRUISE6\")\nastroTest2 &lt;- astroCat %&gt;% \n  group_by(STRATUM, SCIENTIFIC_NAME) %&gt;% \n  summarise(years=n_distinct(YEAR))\n\n########## Asterias\n\n# aLen &lt;- dat_len %&gt;% \n#   filter(SCIENTIFIC_NAME ==\"Asterias\" | #one\n#            SCIENTIFIC_NAME ==\"Asterias rubens (boreal asterias)\"  ) %&gt;% #one\n#   mutate(CRUISE6 = as.factor(CRUISE6),\n#          CRUISE = as.factor(CRUISE),\n#          STATION = as.numeric(STATION),\n#          .keep = \"unused\")\n# \n# aLen &lt;- left_join(aLen, cruises, by=\"CRUISE6\")\n# aTest &lt;- aLen %&gt;% \n#   group_by(STRATUM) %&gt;% \n#   summarise(years=n_distinct(YEAR)) #only one year\n\naCat &lt;- dat_cat %&gt;% \n  filter(SCIENTIFIC_NAME ==\"Asterias\") %&gt;% \n            # | SCIENTIFIC_NAME ==\"Asterias rubens (boreal asterias)\"  ) %&gt;%\n  mutate(CRUISE6 = as.factor(CRUISE6),\n         CRUISE = as.factor(CRUISE),\n         STATION = as.numeric(STATION),\n         .keep = \"unused\")\n\naCat &lt;- left_join(aCat, cruises, by=\"CRUISE6\")\n\naTest2 &lt;- aCat %&gt;% \n  group_by(STRATUM, SCIENTIFIC_NAME) %&gt;% \n  summarise(years=n_distinct(YEAR))\n\naTest20&lt;- aTest2 %&gt;% \n  filter(years &gt; 19)\n  \naCat &lt;- aCat %&gt;% \n  filter(STRATUM %in% (aTest20$STRATUM))\n\nscallopLenOverlap &lt;- len %&gt;% \n  filter(ID %in% aCat$ID)\n\nscallopCatchOverlap &lt;- scallopCat %&gt;% \n  filter(ID %in% aCat$ID) %&gt;% \n  group_by(STRATUM, YEAR) %&gt;% \n  summarize(scallopAvg = mean(EXPCATCHNUM))\n\nasteriasOverlap &lt;- aCat %&gt;% \n  filter(ID %in% scallopCat$ID) %&gt;% \n  group_by(STRATUM, YEAR) %&gt;% \n  summarize(asteriasAvg = mean(EXPCATCHNUM))\n\nscallopCatchOverlap2 &lt;- left_join(scallopCatchOverlap, asteriasOverlap)  %&gt;% \n  pivot_longer(\n    cols = ends_with(\"Avg\"),\n    names_to = \"species\",\n #   names_pattern = \".Avg\",\n    values_to = \"avgCatch\"\n  ) %&gt;% \n  mutate(species = recode(species, \"scallopAvg\" = \"scallop\", \"asteriasAvg\" = \"asterias\"))\n\nggplot(scallopCatchOverlap2, aes(x=YEAR, y = avgCatch, group= STRATUM, color=STRATUM))+geom_line()+facet_wrap(~species)\n\n\n\nscallopCatchOverlap3 &lt;- left_join(scallopCatchOverlap, asteriasOverlap)\nggplot(scallopCatchOverlap3, aes(x=scallopAvg, y = asteriasAvg, group= STRATUM, color=STRATUM))+geom_point()\n\n\n\nformatScal&lt;- scallopCatchOverlap3 %&gt;% \n  group_by(YEAR) %&gt;% \n  summarise(avg = mean(scallopAvg)) %&gt;% \n  ungroup()\n\nformatStar&lt;- scallopCatchOverlap3 %&gt;% \n  group_by(YEAR) %&gt;% \n  summarise(avg = mean(asteriasAvg)) %&gt;% \n  ungroup()\n\nformatStar &lt;- formatStar[!is.na(formatStar$avg),]"
  },
  {
    "objectID": "blog.html",
    "href": "blog.html",
    "title": "All Posts",
    "section": "",
    "text": "Order By\n       Default\n         \n          Title\n        \n         \n          Date - Oldest\n        \n         \n          Date - Newest\n        \n     \n  \n\n\n\n\n\n\n\nWeeks 5 & 6\n\n\n\nWeek 5\n\n\nWeek 6\n\n\n\nA flurry of activity\n\n\n\nJul 9, 2023\n\n\n\n\n\n\n\n\n\n\n\nWeek 4\n\n\n\nWeek 4\n\n\nData exploration\n\n\nNEFMC meeting\n\n\n\nMy activities for the week\n\n\n\nJul 2, 2023\n\n\n\n\n\n\n\n\n\n\n\nSMAST Example\n\n\n\n\n\n\nJun 26, 2023\n\n\n\n\n\n\n\n\n\n\n\nWeek 3\n\n\n\nWeek 3\n\n\nReading\n\n\nData exploration\n\n\n\nMy activities for the week\n\n\n\nJun 23, 2023\n\n\n\n\n\n\n\n\n\n\n\nWeek 2 in R\n\n\n\nWeek 2\n\n\nR\n\n\n\nMy activities for the week\n\n\n\nJun 16, 2023\n\n\n\n\n\n\n\n\n\n\n\nWeek 2 in Words\n\n\n\nWeek 2\n\n\nEvents\n\n\nReading\n\n\nData exploration\n\n\n\nMy activities for the week\n\n\n\nJun 16, 2023\n\n\n\n\n\n\n\n\n\n\n\nJune 13 & 14\n\n\n\nWeek 2\n\n\nData exploration\n\n\nReading\n\n\n\nMaking progress!\n\n\n\nJun 14, 2023\n\n\n\n\n\n\n\n\n\n\n\nJune 12\n\n\n\nWeek 2\n\n\nData exploration\n\n\nReading\n\n\n\nMy activities for the day.\n\n\n\nJun 12, 2023\n\n\n\n\n\n\n\n\n\n\n\nWeek 1 in Words\n\n\n\nWeek 1\n\n\nEvents\n\n\nReading\n\n\n\nMy first week on the job! Lots of getting organized, reading papers, and learning/refreshing my knowledge of Git, GitHub, R Markdown, Python, and Quarto. We also had our…\n\n\n\nJun 9, 2023\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "Maine/Methods.html#log-transform-summarize-and-assess-stationarity",
    "href": "Maine/Methods.html#log-transform-summarize-and-assess-stationarity",
    "title": "Methods",
    "section": "Log-transform, summarize, and assess stationarity",
    "text": "Log-transform, summarize, and assess stationarity\nAll data was log transformed to reduce nonstationarity, which was assessed for each study area using the Kwiatkowski-Phillips-Schmidt-Shin (KPSS) test (Kwiatkowski et al., 1992).\n\n# cleanCatch function includes log transformation; see helpFunctionsMaine script for details\n\ns_cat_clean &lt;- cleanCatch(df_s_cat) %&gt;% \n  mutate(Common_Name = \"Scallop\")\n\nr_cat_clean &lt;- cleanCatch(df_r_cat) %&gt;% \n  mutate(Common_Name = \"Rock\")\n\nj_cat_clean &lt;- cleanCatch(df_j_cat) %&gt;% \n  mutate(Common_Name = \"Jonah\")\n\n#Reorder columns\ncolOrder&lt;-c(\"area\", \"Survey\", \"Tow_Number\", \"Region\", \"Stratum\", \"logCatch\", \"logWt\", \"Expanded_Catch\", \n  \"Expanded_Weight_kg\", \"Date\", \"Common_Name\", \"Number_Caught\", \"Weight_kg\",\n  \"Start_Latitude\", \"Start_Longitude\",\"Season\",\n  \"Year\",\"Grid\", \"Start_Depth_fathoms\", \"End_Depth_fathoms\",\n  \"Bottom_WaterTemp_DegC\", \"Bottom_Salinity\")\n\nj_cat_clean &lt;- j_cat_clean %&gt;% select(all_of(colOrder))\nr_cat_clean &lt;- r_cat_clean %&gt;% select(all_of(colOrder))\ns_cat_clean &lt;- s_cat_clean %&gt;% select(all_of(colOrder))\n\n#computes averages for each study area (area = region-stratum combination)\nj_cat_sum &lt;- summaryCatch(j_cat_clean)\nr_cat_sum &lt;- summaryCatch(r_cat_clean)\ns_cat_sum &lt;- summaryCatch(s_cat_clean)\n\ncatch &lt;- s_cat_sum %&gt;% left_join(j_cat_sum, by=c(\"area\", \"Season\", \"Region\", \"Stratum\", \"Year\"), suffix = c(\"_s\", \"_j\"))\ncatch &lt;- catch %&gt;% left_join(r_cat_sum, by=c(\"area\", \"Season\", \"Region\", \"Stratum\", \"Year\")) %&gt;% \n  mutate(avgCatch_r = avgCatch,avgWt_r = avgWt,avgLogCatch_r = avgLogCatch,avgLogWt_r = avgLogWt, .keep=\"unused\")\n\ncatchTidy &lt;- pivot_longer(catch, \n        cols = 6:ncol(catch)) %&gt;% \n  mutate(Type = case_when(\n    startsWith(name, \"avgCatch_\") ~\"catch\",\n    startsWith(name,\"avgWt_\") ~\"wt\",\n    startsWith(name,\"avgLogWt\") ~\"logWt\",\n    startsWith(name,\"avgLogCatch\") ~\"logCatch\")) %&gt;% \n  mutate(Species = case_when(\n    endsWith(name, \"s\") ~\"scallop\",\n    endsWith(name, \"r\") ~\"rock\",\n    endsWith(name, \"j\") ~\"jonah\"))\n\ncatchTidy &lt;- catchTidy %&gt;% mutate(area = as.factor(area), Species = as.factor(Species),Season = as.factor(Season),Region = as.factor(Region), Stratum = as.factor(Stratum)) %&gt;% \n          select(-name)\n\nlogCatchFall &lt;- catchTidy %&gt;% filter(Type == \"logCatch\") %&gt;% filter(Season == \"Fall\")\nlogWtFall &lt;- catchTidy %&gt;% filter(Type == \"logWt\") %&gt;% filter(Season == \"Fall\")\n\n#Note that the highest p-value the kpss.test function will show is 0.1, actual p-values may be higher\nfindSpeciesKPSS(logCatchFall %&gt;% filter(Species==\"scallop\"), season=\"Fall\", type=\"logCatch\")\n\n# A tibble: 5 × 4\n     `1`    `2`    `3`   `4`\n   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;\n1 0.1    0.1    0.1      0.1\n2 0.1    0.0383 0.0237   0.1\n3 0.1    0.0248 0.0177   0.1\n4 0.1    0.0539 0.01     0.1\n5 0.0766 0.0776 0.1      0.1\n\nfindSpeciesKPSS(logCatchFall %&gt;% filter(Species==\"rock\"), season=\"Fall\", type=\"logCatch\")\n\n# A tibble: 5 × 4\n    `1`    `2`   `3`      `4`\n  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1   0.1 0.1      0.1 NaN     \n2   0.1 0.0497   0.1   0.1   \n3   0.1 0.0347   0.1   0.1   \n4   0.1 0.0432   0.1   0.0914\n5   0.1 0.1      0.1   0.1   \n\nfindSpeciesKPSS(logCatchFall %&gt;% filter(Species==\"jonah\"), season=\"Fall\", type=\"logCatch\")\n\n# A tibble: 5 × 4\n     `1`   `2`   `3`   `4`\n   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 0.0223   0.1   0.1   0.1\n2 0.0646   0.1   0.1   0.1\n3 0.1      0.1   0.1   0.1\n4 0.1      0.1   0.1   0.1\n5 0.1      0.1   0.1   0.1\n\nfindSpeciesKPSS(logWtFall %&gt;% filter(Species==\"scallop\"), season=\"Fall\", type=\"logWt\")\n\n# A tibble: 5 × 4\n     `1`    `2`    `3`    `4`\n   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;\n1 0.0794 0.0948 0.1    0.1   \n2 0.1    0.0674 0.0528 0.1   \n3 0.1    0.0385 0.0428 0.1   \n4 0.1    0.0410 0.0149 0.0495\n5 0.0689 0.1    0.1    0.1   \n\nfindSpeciesKPSS(logWtFall %&gt;% filter(Species==\"rock\"), season=\"Fall\", type=\"logWt\")\n\n# A tibble: 5 × 4\n     `1`    `2`    `3`      `4`\n   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;\n1 0.1    0.1    0.1    NaN     \n2 0.0372 0.0881 0.1      0.1   \n3 0.1    0.0183 0.1      0.1   \n4 0.1    0.1    0.0932   0.0832\n5 0.1    0.1    0.1      0.1   \n\nfindSpeciesKPSS(logWtFall %&gt;% filter(Species==\"jonah\"), season=\"Fall\", type=\"logWt\")\n\n# A tibble: 5 × 4\n     `1`    `2`   `3`   `4`\n   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 0.0303 0.1      0.1   0.1\n2 0.0439 0.0979   0.1   0.1\n3 0.1    0.1      0.1   0.1\n4 0.1    0.1      0.1   0.1\n5 0.1    0.1      0.1   0.1"
  },
  {
    "objectID": "posts/Week5.html",
    "href": "posts/Week5.html",
    "title": "Weeks 5 & 6",
    "section": "",
    "text": "I spent most of the day working with the scallop data that Dr. Hart emailed me on Friday. As she requested, I created an R script that turns the data file she gave me into two data frames with lists of 3 or more consecutive stations that have been labeled as star/crab samples not taken. I also manually read the catch comment for each station to evaluate the possibility that crabs/starfish might have been sampled at that station and the catch photo needs to be checked.\nI worked through the SCC+Bash BRITE Workshop materials that Michael emailed us so I will be prepared for the workshop on Thursday. I learned a great deal of new syntax and practiced creating and running basic bash scripts on the SCC."
  },
  {
    "objectID": "posts/Week5.html#monday-july-3-preceding-weekend",
    "href": "posts/Week5.html#monday-july-3-preceding-weekend",
    "title": "Weeks 5 & 6",
    "section": "",
    "text": "I spent most of the day working with the scallop data that Dr. Hart emailed me on Friday. As she requested, I created an R script that turns the data file she gave me into two data frames with lists of 3 or more consecutive stations that have been labeled as star/crab samples not taken. I also manually read the catch comment for each station to evaluate the possibility that crabs/starfish might have been sampled at that station and the catch photo needs to be checked.\nI worked through the SCC+Bash BRITE Workshop materials that Michael emailed us so I will be prepared for the workshop on Thursday. I learned a great deal of new syntax and practiced creating and running basic bash scripts on the SCC."
  },
  {
    "objectID": "posts/Week5.html#tuesday-july-4",
    "href": "posts/Week5.html#tuesday-july-4",
    "title": "Weeks 5 & 6",
    "section": "Tuesday, July 4",
    "text": "Tuesday, July 4\nAlthough today was technically a holiday, today I… 1. Worked through athlete survey/sensor repository Dr. Deyle shared with me 2. Based on clarification provided by Dr. Hart, I created a list of the stations with a comment mentioning “stars and crabs” (affirmative). I also made an updated version of the csv file I sent previously that lists the first stations in runs of 3+ consecutive stations with “starsample = FALSE”. The new version excludes five such runs that would not exist if the stations with a “stars and crabs” comment were all changed to “starsample = TRUE”."
  },
  {
    "objectID": "posts/Week5.html#wednesday-july-5",
    "href": "posts/Week5.html#wednesday-july-5",
    "title": "Weeks 5 & 6",
    "section": "Wednesday, July 5",
    "text": "Wednesday, July 5\n\nMaine data: grid overlays\nFunction to do EDM on Maine-formatted input file"
  },
  {
    "objectID": "posts/Week5.html#thursday-july-6",
    "href": "posts/Week5.html#thursday-july-6",
    "title": "Weeks 5 & 6",
    "section": "Thursday, July 6",
    "text": "Thursday, July 6\n\nBRITE Programming Workshop: Bash/Linux\nWorking on identifying nearest neighbors"
  },
  {
    "objectID": "posts/Week5.html#friday-july-7",
    "href": "posts/Week5.html#friday-july-7",
    "title": "Weeks 5 & 6",
    "section": "Friday, July 7",
    "text": "Friday, July 7\n\nWriting functions to bootstrap samples\nMeeting with Dr. Deyle, Josue, and Dr. Suchi Gopal"
  },
  {
    "objectID": "posts/Week5.html#monday-july-10-preceding-weekend",
    "href": "posts/Week5.html#monday-july-10-preceding-weekend",
    "title": "Weeks 5 & 6",
    "section": "Monday, July 10 (+ preceding weekend)",
    "text": "Monday, July 10 (+ preceding weekend)\n\nRotjan lab meeting\nVoronoi polygons and Moran’s I - assessing spatial autocorrelation\nWorking on loop to find avg E, rho using bootstrapped/Frankenstein strata"
  },
  {
    "objectID": "posts/Week5.html#tuesday-july-11",
    "href": "posts/Week5.html#tuesday-july-11",
    "title": "Weeks 5 & 6",
    "section": "Tuesday, July 11",
    "text": "Tuesday, July 11\n\nStart exploration of crab data\nUsing E from the loop I developed yesterday to do CCM with the crab data"
  },
  {
    "objectID": "posts/Week5.html#wednesday-july-12",
    "href": "posts/Week5.html#wednesday-july-12",
    "title": "Weeks 5 & 6",
    "section": "Wednesday, July 12",
    "text": "Wednesday, July 12\n\nContinuing to work on CCM functions, graphing results\nI went through the code I’ve written so far and cleaning it up so everything is clear and reproducible. I’m creating a more organized RMarkdown script (getting rid of things like “test1” “test2”) and an accompanying Methods document that describes what/how/why I did what I did."
  },
  {
    "objectID": "posts/Week5.html#thursday-july-13",
    "href": "posts/Week5.html#thursday-july-13",
    "title": "Weeks 5 & 6",
    "section": "Thursday, July 13",
    "text": "Thursday, July 13\n\nBRITE Programming Workshop: Data visualization\nBioinfo Challenge Project Presentations\nContinued working on Methods document"
  },
  {
    "objectID": "posts/Week5.html#friday-july-14",
    "href": "posts/Week5.html#friday-july-14",
    "title": "Weeks 5 & 6",
    "section": "Friday, July 14",
    "text": "Friday, July 14\n\nMeeting with Dr. Deyle\nMethods, CCM\nLots of geospatial analysis: investigating spatial bootstrapping methods"
  },
  {
    "objectID": "posts/Week5.html#monday-july-17th",
    "href": "posts/Week5.html#monday-july-17th",
    "title": "Weeks 5 & 6",
    "section": "Monday, July 17th",
    "text": "Monday, July 17th\n\nS-mapping\nRe-ran untransformed data\nCo-prediction script\nNSF GFRP webinar at 4pm, so couldn’t make it to the Rotjan lab meeting"
  },
  {
    "objectID": "posts/Week5.html#tuesday-july-18",
    "href": "posts/Week5.html#tuesday-july-18",
    "title": "Weeks 5 & 6",
    "section": "Tuesday, July 18",
    "text": "Tuesday, July 18\n\nLooked at mabmeans data Dr. Hart sent\nStarted working with the data in ts format to remove seasonality, hoping that incorporating the additional data will improve predictability. Read a lot about time series analysis\nhttps://zanna-researchteam.github.io/"
  },
  {
    "objectID": "jonahMethods.html",
    "href": "jonahMethods.html",
    "title": "Methods - Jonah Crab",
    "section": "",
    "text": "#Load packages\nlibrary(tidyverse)\nlibrary(lubridate) #date formatting\nlibrary(patchwork) #combining plots\nlibrary(rEDM) #EDM\nlibrary(sf) #for spatial data"
  },
  {
    "objectID": "jonahMethods.html#load-packages",
    "href": "jonahMethods.html#load-packages",
    "title": "Methods - Jonah Crab",
    "section": "",
    "text": "#Load packages\nlibrary(tidyverse)\nlibrary(lubridate) #date formatting\nlibrary(patchwork) #combining plots\nlibrary(rEDM) #EDM\nlibrary(sf) #for spatial data"
  },
  {
    "objectID": "jonahMethods.html#import-data",
    "href": "jonahMethods.html#import-data",
    "title": "Methods - Jonah Crab",
    "section": "Import data",
    "text": "Import data\n\ndf_tows&lt;-read.csv(\"data/Maine_inshore_trawl/MEtows.csv\") #tow data\ndf_s_cat&lt;- read.csv(\"data/Maine_inshore_trawl/MEscallopCatch.csv\") #scallop catch\ndf_r_cat&lt;- read.csv(\"data/Maine_inshore_trawl/MErockCatch.csv\") #rock crab catch\ndf_j_cat&lt;- read.csv(\"data/Maine_inshore_trawl/MEjonahCatch.csv\") #jonah crab catch\n\nsurveyGrid &lt;-st_read(\"~/Downloads/lab_notebook/Maine/MaineDMR_-_Inshore_Trawl_Survey_Grid\") #CRS: WGS 84/EPSG 4326\n\nReading layer `MaineDMR_-_Inshore_Trawl_Survey_Grid' from data source \n  `/Users/rubykrasnow/Downloads/lab_notebook/Maine/MaineDMR_-_Inshore_Trawl_Survey_Grid' \n  using driver `ESRI Shapefile'\nSimple feature collection with 3698 features and 9 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -70.81288 ymin: 42.86466 xmax: -66.88822 ymax: 44.81316\nGeodetic CRS:  WGS 84\n\n\nRename and add variables to survey grid\n\nsurveyGrid &lt;- surveyGrid %&gt;% \n  mutate(Region = region_id,\n         Stratum = depth_stra,\n         GridID = grid_id, .keep=\"unused\", .before=last_surve)\n\nsurveyGrid$area &lt;- as.numeric(paste0(surveyGrid$Region, surveyGrid$Stratum))"
  }
]